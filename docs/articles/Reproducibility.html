<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reproducibility • zoontutorials</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">zoontutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Choosing_A_Modelling_Method.html">Choosing A Modelling Method</a>
    </li>
    <li>
      <a href="../articles/Data_Exploration.html">Data exploration</a>
    </li>
    <li>
      <a href="../articles/Data_Sources.html">Data Sources</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to SDMs</a>
    </li>
    <li>
      <a href="../articles/Model_Validation.html">Model Evaluation</a>
    </li>
    <li>
      <a href="../articles/Reproducibility.html">Reproducibility</a>
    </li>
    <li>
      <a href="../articles/Selecting_Covariates.html">Selecting and preparing covariates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Reproducibility</h1>
                        <h4 class="author">David Wilkinson</h4>
            
            <h4 class="date">11 July 2017</h4>
          </div>

    
    
<div class="contents">
<hr>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>One of the hot topics in science recently has been the issue of reproducibility <span class="citation">(Baker 2016)</span>. While we wont explore this issue here, the inability of researchers to reproduce, scrutinise, and build on others’ research prevents rigorous peer review, synthesis of research findings across studies, and reduces capacity for the science to be a self-correcting process <span class="citation">(Boulton et al. 2012)</span>.</p>
<p>In order to overcome these problems, the data and code underpinning SDM research need to be made more accessible, reproducible and modifiable by the whole research community. This can be achieved if technologies enable and encourage sharing of research as fully reproducible objects <span class="citation">(Peng 2011)</span>, in ways that suit the diversity of users involved in SDM <span class="citation">(Ahmed et al. 2015)</span>.</p>
<p>The zoon R package has been developed specifically to improve the reproducibility of SDMs by allowing users to encode entire SDM analyses as repeatable and extensible workflows consisting of independently executable, community-contributed modules. The module-workflow structure enables scientists to easily create and share components of their analysis; and then access, modify, reuse and combine the components of others (see below and Figure 1).</p>
<p>In this guide we will cover the ways in which zoon aids reproducibility in SDM analysis.</p>
<hr>
</div>
<div id="the-zoon-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#the-zoon-workflow" class="anchor"></a>The <code>zoon</code> workflow</h1>
<p>While the <code>workflow()</code> in <code>zoon</code> is capable of fitting basic SDMs with a minimal amount of code, one of its strengths is the ability to perform more elaborate analyses using the <code>Chain()</code> and <code>list()</code> functions to run multiple modules in series and/or parallel. Here is a moderately complex example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example &lt;-<span class="st"> </span><span class="kw">workflow</span>(<span class="dt">occurrence =</span> <span class="kw">SpOcc</span>(<span class="dt">species =</span> <span class="st">"Ursus arctos"</span>,
                                       <span class="dt">extent =</span> <span class="kw">c</span>(-<span class="dv">175</span>, -<span class="dv">65</span>, <span class="dv">20</span>, <span class="dv">75</span>),
                                       <span class="dt">databases =</span> <span class="st">"gbif"</span>,
                                       <span class="dt">type =</span> <span class="st">"presence"</span>),
                    <span class="dt">covariate =</span> <span class="kw">Bioclim</span>(<span class="dt">extent =</span> <span class="kw">c</span>(-<span class="dv">175</span>, -<span class="dv">65</span>, <span class="dv">20</span>, <span class="dv">75</span>),
                                        <span class="dt">resolution =</span> <span class="dv">10</span>,
                                        <span class="dt">layers =</span> <span class="dv">1</span>:<span class="dv">19</span>),
                    <span class="dt">process =</span> <span class="kw">Chain</span>(Clean,
                                    <span class="kw">Background</span>(<span class="dv">1000</span>),            ### This chunk is evaluated and not
                                    StandardiseCov,              ### shown/printed to screen
                                    <span class="kw">Crossvalidate</span>(<span class="dt">k =</span> <span class="dv">5</span>)),       ### Next chunk is not evaluated
                    <span class="dt">model =</span> <span class="kw">list</span>(LogisticRegression,             ### But chunk code shown
                                 MaxNet,
                                 RandomForest),
                    <span class="dt">output =</span> <span class="kw">Chain</span>(PrintMap,
                                   PerformanceMeasures),
                    <span class="dt">forceReproducible =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Reproducibility_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Here we fit three modelling methods to data sourced from online repositories, perform multiple pre-processing steps in sequence, and generate multiple outputs for each model.</p>
<p>An issue with reproducing the results of an SDM analysis like the one above <em>without</em> having access to the code (e.g. based only on the Methods section of a published paper) is ensuring that all of the steps are undertaken in the same order with the same parameters. Even the choice of computer program (as well as different versions of both the program and add-on packages) can affect the chances of replicating results. The <code>workflow()</code> function has been designed specifically to overcome these difficulties.</p>
<p>First up is the <code>forceReproducible</code> argument within the <code>workflow()</code> function itself. When set to <code>TRUE</code> it forces the function to obtain all called modules from the online repository. This prevents any issues from arising due to users working with modified versions of modules stored locally on their own computer.</p>
<div id="object-calls" class="section level2">
<h2 class="hasAnchor">
<a href="#object-calls" class="anchor"></a>Object calls</h2>
<p>When our workflow is saved into our environment as a <code>zoonWorkflow</code> object, we can make calls to it directly to return the commands needed to re-run the analysis, find out information about the computer it was run on, what versions of R packages were used, and which version of each zoon module was used.</p>
<p>We can obtain the code used to run a workflow by accessing the <code>call</code> attribute of our <code>workflow</code>. This lets us see exactly what choices were made by another user when they fit their <code>workflow()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example$call</code></pre></div>
<pre><code>## [1] "workflow(occurrence = SpOcc(species = \"Ursus arctos\", extent = c(-175, -65, 20, 75),      databases = \"gbif\", type = \"presence\"), covariate = Bioclim(extent = c(-175, -65, 20, 75), resolution = 10, layers = 1:19), process = Chain(Clean, Background(1000), StandardiseCov, Crossvalidate(k = 5)), model = list(LogisticRegression, MaxNet, RandomForest), output = Chain(PrintMap, PerformanceMeasures), forceReproducible = TRUE)"</code></pre>
<p>On occassion there may still be differences in the output of a <code>workflow</code> despite being called with the exact same code. This is often related to different users running the code on different operating systems, different versions of R, with different package versions (<code>zoon</code> or otherwise), and/or different versions of <code>zoon</code> modules. These can be checked by accessing the <code>session.info</code> and <code>module.versions</code> attributes of a <code>zoonWorkflow</code> object.</p>
<p><code>session.info</code> stores the non-zoon information about the analysis including the version of R used, the user’s operating system, and the version numbers of the packages loaded for the analysis. <code>module.info</code> stores the version numbers of the modules used in the analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example$session.info</code></pre></div>
<pre><code>## R version 3.4.2 (2017-09-28)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] zoon_0.6.2   raster_2.5-8 sp_1.2-5    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.13        plyr_1.8.4          compiler_3.4.2     
##  [4] R.methodsS3_1.7.1   bitops_1.0-6        R.utils_2.5.0      
##  [7] tools_3.4.2         SDMTools_1.1-221    testthat_1.0.2     
## [10] digest_0.6.12       dotCall64_0.9-04    tibble_1.3.4       
## [13] gtable_0.2.0        rfigshare_0.3.7     evaluate_0.10.1    
## [16] lattice_0.20-35     rlang_0.1.2.9000    rstudioapi_0.7     
## [19] commonmark_1.4      yaml_2.1.14         rgdal_1.2-13       
## [22] spam_2.1-1          dismo_1.1-4         httr_1.3.1         
## [25] stringr_1.2.0       roxygen2_6.0.1      xml2_1.1.1         
## [28] knitr_1.17          fields_9.0          maps_3.2.0         
## [31] rprojroot_1.2       grid_3.4.2          R6_2.2.2           
## [34] XML_3.98-1.9        foreign_0.8-69      rmarkdown_1.6      
## [37] RJSONIO_1.3-0       rworldmap_1.3-6     ggplot2_2.2.1      
## [40] magrittr_1.5        scales_0.5.0        backports_1.1.1    
## [43] htmltools_0.3.6     maptools_0.9-2      randomForest_4.6-12
## [46] colorspace_1.3-2    httpuv_1.3.5        stringi_1.1.5      
## [49] lazyeval_0.2.0      munsell_0.4.3       RCurl_1.95-4.8     
## [52] crayon_1.3.4        R.oo_1.21.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">example$module.versions</code></pre></div>
<pre><code>## $occurrence
##         [,1]   
## module  "SpOcc"
## version "1.0"  
## 
## $covariate
##         [,1]     
## module  "Bioclim"
## version "1.1"    
## 
## $process
##         [,1]    [,2]         [,3]             [,4]           
## module  "Clean" "Background" "StandardiseCov" "Crossvalidate"
## version "1.1"   "1.3"        "0"              "1.0"          
## 
## $model
##         [,1]                 [,2]     [,3]          
## module  "LogisticRegression" "MaxNet" "RandomForest"
## version "1.0"                "1.0"    "1.1"         
## 
## $output
##         [,1]       [,2]                 
## module  "PrintMap" "PerformanceMeasures"
## version "1.2"      "1.0"</code></pre>
<hr>
</div>
</div>
<div id="saveload" class="section level1">
<h1 class="hasAnchor">
<a href="#saveload" class="anchor"></a>Save/Load</h1>
<p>As <code>workflow()</code> functions are saved as objects of class <code>zoonWorkflow</code> they can be saved to file and shared between users. This object contains all of the code needed to re-run the analysis, all of the data used, and all of the results. We can save a <code>zoonWorkflow</code> object as a single .RData object with R’s <code>save()</code> command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(example, <span class="dt">file =</span> <span class="st">'workflow.RData'</span>)</code></pre></div>
<p>And reload it with <code>load()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">'workflow.RData'</span>)</code></pre></div>
<p>This allows the entire data analysis process (data, model, and output) to be shared between users.</p>
<hr>
</div>
<div id="rerunworkflow" class="section level1">
<h1 class="hasAnchor">
<a href="#rerunworkflow" class="anchor"></a>RerunWorkflow</h1>
<p>The <code>RerunWorkflow()</code> function takes a <code>zoonWorkflow</code> object and reruns it. This lets us try to reproduce our own analysis or that of someone else provided we have access to the <code>zoonWorkflow</code> object. If you only want to rerun the workflow from a certain point onwards (such as keeping the same data from an online repository but with new background data) then you can use the <code>from</code> argument to specify a starting point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RerunWorkflow</span>(example)</code></pre></div>
<hr>
</div>
<div id="zoonfigshare" class="section level1">
<h1 class="hasAnchor">
<a href="#zoonfigshare" class="anchor"></a><code>ZoonFigshare()</code>
</h1>
<p>The <code>ZoonFigshare()</code> function lets us upload our <code>zoonWorkflow</code> object to figshare, and online digital repository. figshare provides a service where researchers can freely preserve and share their research online. This is a useful function for making your research accessible to researchers all around the globe and not just to those in direct contact with you and aware of your work. This function connects with figshare via your internet browser and will require you to have a registered account. You can supply additional arguments to the function to add information to the figshare object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ZoonFigshare</span>(<span class="dt">zoonWorkflow =</span> example,
             <span class="dt">title =</span> <span class="st">"Example"</span>,
             <span class="dt">description =</span> <span class="st">"Our example workflow"</span>,
             <span class="dt">authors =</span> <span class="st">"Zoon Team"</span>,
             <span class="dt">categories =</span> <span class="st">"ecology"</span>,
             <span class="dt">tags =</span> <span class="kw">c</span>(<span class="st">"ecology"</span>, <span class="st">"zoon"</span>, <span class="st">"species distribution model"</span>))</code></pre></div>
<hr>
<div id="refs" class="references">
<div id="ref-Ahmed2015">
<p>Ahmed, Sadia E., Greg Mcinerny, Kenton O’Hara, Richard Harper, Lara Salido, Stephen Emmott, and Lucas N. Joppa. 2015. “Scientists and Software - Surveying the Species Distribution Modelling Community.” <em>Diversity and Distributions</em> 21 (3): 258–67. doi:<a href="https://doi.org/10.1111/ddi.12305">10.1111/ddi.12305</a>.</p>
</div>
<div id="ref-Baker2016">
<p>Baker, Monya. 2016. “Is There a Reproducibility Crisis?” <em>Nature</em> 533: 452–54. doi:<a href="https://doi.org/10.1038/533452a">10.1038/533452a</a>.</p>
</div>
<div id="ref-Boulton2012">
<p>Boulton, Geoffrey, Philip Campbell, Brian Collins, Peter Elias, Wendy Hall, Laurie Graeme, Onora O’Neill, et al. 2012. <em>Science as an Open Enterprise</em>. June.</p>
</div>
<div id="ref-Peng2011">
<p>Peng, RD. 2011. “Reproducible Research in Computational Science.” <em>Science</em> 334 (6060): 1226.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#the-zoon-workflow">The <code>zoon</code> workflow</a><ul class="nav nav-pills nav-stacked">
<li><a href="#object-calls">Object calls</a></li>
      </ul>
</li>
      <li><a href="#saveload">Save/Load</a></li>
      <li><a href="#rerunworkflow">RerunWorkflow</a></li>
      <li><a href="#zoonfigshare"><code>ZoonFigshare()</code></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nick Golding, David Wilkinson, Liz Martin, Saras Windecker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
