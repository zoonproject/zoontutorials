<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data exploration • zoontutorials</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">zoontutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Data exploration</h1>
            
          </div>

    
    
<div class="contents">
<hr>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>When we undertake a Species Distribution Model (SDM) we use both species occurrence data collected from field surveys or collated observations, as well as environmental predictor data. Before beginning to use covariate data to model occurrence over space, a crucial first step is to familiarise ourselves with the data and its limitations. It is important to do this before modelling the data, as data exploration can result in consequences for the choice of model applied as well as the accurracy of the inference taken from the model. Equally, choice of model a priori may bring a unique set of assumptions that we need to check for in our data. This guide outlines a few suggested steps implemented in both base R as well as using <code>zoon</code> <code>output</code> and <code>process</code> modules for data exploration (Figure 1), but is by no means exhaustive.</p>
<div class="figure" style="text-align: center">
<img src="../vignettes/Images/DataExp_ConceptualDiagram.png" alt="*Figure 1. Data exploration considerations for occurence and covariate data*" width="400px"><p class="caption">
<em>Figure 1. Data exploration considerations for occurence and covariate data</em>
</p>
</div>
<hr>
</div>
<div id="data-summary" class="section level1">
<h1 class="hasAnchor">
<a href="#data-summary" class="anchor"></a>Data summary</h1>
<p>To begin to familiarise ourselves with the data, it is very useful to examine summary information, including min, mean, and max values for each covariate that you have loaded. Environmental covariate data is subject to error. For example, maybe the maximum value in your elevation variable is 1000 m, but you know that the highest peak in your study region is only 500 m. Maybe your vegetation classification shows ten levels despite it being an eight-category scale.</p>
<p>It can also help us to check the format of the covariates - to ensure continuous variables are stored as numeric data and categorical variables as factors. Categorical variables may be erroneously listed in a numerical index (e.g. vegetation categories identified as 1-10), causing them to be mis-classed. Similarly, if there are any typos in numerical data entries that introduce characters (e.g. ‘2 cm’ instead of ‘2’), then a continuous variable could be classed as a factor.</p>
<p>NA values are to be expected in our raster data as they are commonly masked to cover only a particular region, however finding NA values for covariates in the training data could indicate that some data points have incorrect latitude/longitude values. This can result from being mapped to locations outide the extent of our study, or suggest that the data point sits on the border of the study region and misses the raster due to its resolution and should be adjusted slightly.</p>
<p>With the <code>zoon</code> output module <code>DataSummary</code>, examining covariate data for these potential pitfalls is very easy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zoon)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Carolina_Wren_Workflow &lt;-<span class="st"> </span><span class="kw">workflow</span>(<span class="dt">occurrence =</span> CarolinaWrenPO,
                                   <span class="dt">covariate =</span> CarolinaWrenRasters,
                                   <span class="dt">process =</span> <span class="kw">Background</span>(<span class="dv">1000</span>),
                                   <span class="dt">model =</span> NullModel,
                                   <span class="dt">output =</span> DataSummary)</code></pre></div>
<pre><code>$PointData
   longitude          latitude         pcMix              pcDec        
 Min.   :-100.19   Min.   :25.10   Min.   :-0.28163   Min.   :-0.4023  
 1st Qu.: -90.09   1st Qu.:32.47   1st Qu.:-0.25373   1st Qu.:-0.1441  
 Median : -84.22   Median :35.90   Median : 0.07983   Median : 1.0642  
 Mean   : -85.09   Mean   :35.54   Mean   : 0.51684   Mean   : 1.4522  
 3rd Qu.: -80.24   3rd Qu.:38.74   3rd Qu.: 0.81348   3rd Qu.: 2.5997  
 Max.   : -70.01   Max.   :43.48   Max.   : 9.72729   Max.   : 5.7853  
     pcCon              pcGr              Lat                Lon         
 Min.   :-0.4118   Min.   :-0.4333   Min.   :-1.47041   Min.   :-0.2513  
 1st Qu.:-0.3641   1st Qu.:-0.4028   1st Qu.:-0.69941   1st Qu.: 0.2841  
 Median :-0.1350   Median :-0.3277   Median :-0.25919   Median : 0.5832  
 Mean   : 0.2708   Mean   :-0.1669   Mean   :-0.29397   Mean   : 0.5262  
 3rd Qu.: 0.7252   3rd Qu.:-0.1607   3rd Qu.: 0.09957   3rd Qu.: 0.7851  
 Max.   : 3.5748   Max.   : 4.4750   Max.   : 0.83779   Max.   : 1.1720  

$RasterData
     pcMix           pcDec           pcCon            pcGr      
 Min.   :-0.28   Min.   :-0.40   Min.   :-0.41   Min.   :-0.43  
 1st Qu.:-0.28   1st Qu.:-0.40   1st Qu.:-0.41   1st Qu.:-0.38  
 Median :-0.27   Median :-0.34   Median :-0.27   Median :-0.22  
 Mean   : 0.25   Mean   : 0.34   Mean   : 0.36   Mean   : 0.38  
 3rd Qu.: 0.06   3rd Qu.: 0.58   3rd Qu.: 0.66   3rd Qu.: 0.55  
 Max.   :10.95   Max.   : 5.79   Max.   : 5.67   Max.   : 5.12  
 NA's   :35451   NA's   :35451   NA's   :35451   NA's   :35451  
      Lat             Lon       
 Min.   :-1.56   Min.   :-1.34  
 1st Qu.:-0.34   1st Qu.:-0.69  
 Median : 0.22   Median :-0.17  
 Mean   : 0.18   Mean   :-0.15  
 3rd Qu.: 0.74   3rd Qu.: 0.35  
 Max.   : 1.51   Max.   : 1.26  
 NA's   :35451   NA's   :35451  </code></pre>
<p><strong>EXPAND ON WHAT WE SEE ONCE THE UPDATED MODULE PULL REQUEST GOES THROUGH</strong></p>
<hr>
</div>
<div id="outliersdata-cleaning" class="section level1">
<h1 class="hasAnchor">
<a href="#outliersdata-cleaning" class="anchor"></a>Outliers/data cleaning</h1>
<p>Species distribution datasets are, to varying degrees, reliant on observation records gathered by humans and therefore subject to human error. Even in situations where we are fitting a model to entirely remotely-sensed data such as bioclimatic variables, our species occurrence records are usually pen-and-paper recordings from the field. This manual data entry can lead to mistakes. One way to check for nonsense entries is to the plot occurrence data to covariates one by one, allowing us to isolate unusual entries. For example, if we plotted against latitude, we might see a single occurrence value at a latitude outside the range of our study.</p>
<p>You can visualise these plots using the <code>CovHistogram</code> output module.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Carolina_Wren_Workflow &lt;-<span class="st"> </span><span class="kw">workflow</span>(<span class="dt">occurrence =</span> CarolinaWrenPO,
                                   <span class="dt">covariate =</span> CarolinaWrenRasters,
                                   <span class="dt">process =</span> <span class="kw">Background</span>(<span class="dv">1000</span>),
                                   <span class="dt">model =</span> NullModel,
                                   <span class="dt">output =</span> CovHistograms)</code></pre></div>
<p><img src="Data_Exploration_files/figure-html/relationships%20workflow-1.png" width="672" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="collinearity" class="section level1">
<h1 class="hasAnchor">
<a href="#collinearity" class="anchor"></a>Collinearity</h1>
<p>Collinearity is the existence of correlations among covariates, for example between altitude and temperature. For some modelling methods, though notably not all of them, when two covariates in a model are correlated, the modelling method may struggle to identify the impact of each variable independently and the significance of either may be masked. If covariate A and covariate B are correlated, one approach would be to include a single one in the model, preferably based on sound biological justification. Should variable A be included, then in the discussion of the results it will be important to note that the observed effect could equally be driven by correlated covariate B.</p>
<p>You can check for collinearity in many ways, but the simplest is to look at a pair plot of your covariate data. You can do this using the <code>zoon</code> output module <code>PairPlot</code>. The upper panel shows a density scatterplots of relationships between covariates, the diagonal panel shows a density of the points as well as variable names, and the lower panel shows the <span class="math inline">\(r^2\)</span> correlation values where darker colours indicate stronger correlation (blue in the positive direction, red in the negative).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Carolina_Wren_Workflow &lt;-<span class="st"> </span><span class="kw">workflow</span>(<span class="dt">occurrence =</span> CarolinaWrenPO,
                                   <span class="dt">covariate =</span> CarolinaWrenRasters,
                                   <span class="dt">process =</span> <span class="kw">Background</span>(<span class="dv">1000</span>),
                                   <span class="dt">model =</span> NullModel,
                                   <span class="dt">output =</span> PairPlot)</code></pre></div>
<p><img src="Data_Exploration_files/figure-html/pairplot%20workflow-1.png" width="672" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="covariate-report" class="section level1">
<h1 class="hasAnchor">
<a href="#covariate-report" class="anchor"></a>Covariate Report</h1>
<p>A tidy summary of many of these data exploration methods is provided with the <code>GenerateCovariateReport</code> <code>Output</code> module. This is based on the <code>GenerateReport()</code> function in the <code>DataExplorer</code> <code>R</code> package, but tailored specifically for SDM analyses. These reports show our data structure, the percentage of missing data, the distribution of our covariates (histograms for continuous data, bar charts for discrete), and show the results of a basic correlation analysis. We need to tell the module which report(s) to generate by setting the <code>type</code> argument to one of “D” (Data Report only), “R” (Raster report only), or “DR” (Data and Raster Report).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output =<span class="st"> </span><span class="kw">GenerateCovariateReport</span>(<span class="dt">type =</span> <span class="st">"DR"</span>)</code></pre></div>
<hr>
</div>
<div id="accessor-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#accessor-functions" class="anchor"></a>Accessor functions</h1>
<p>Where there is no module already designed, we can manipulate our data directly by using the accessor function <code>Process()</code> to generate a dataframe object with extracted raster covariate values for each occurrence point. We can examine the first six rows of this data frame by using the base R function <code>head()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">occ.cov.df &lt;-<span class="st"> </span><span class="kw">Process</span>(Carolina_Wren_Workflow)<span class="op">$</span>df
<span class="kw">head</span>(occ.cov.df)</code></pre></div>
<pre><code>  longitude latitude value     type fold     pcMix     pcDec      pcCon
1 -87.50607 34.92022     1 presence    1 0.5902465 1.8175174 -0.2232220
2 -87.78094 34.93984     1 presence    1 0.3973857 1.8771694 -0.1192491
3 -88.05596 34.95882     1 presence    1 1.5005269 2.5864888  0.2768159
4 -86.73598 34.41256     1 presence    1 1.0277690 1.6152677 -0.1380109
5 -86.70923 34.63505     1 presence    1 0.7697110 1.4580649 -0.1153329
6 -86.98288 34.65655     1 presence    1 0.6184651 0.5775564 -0.2159737
        pcGr        Lat       Lon
1 -0.3189337 -0.4050766 0.4139044
2 -0.3031093 -0.4075254 0.3991733
3 -0.2853706 -0.4098892 0.3844383
4 -0.3246833 -0.4765890 0.4622093
5 -0.3219977 -0.4501391 0.4608309
6 -0.3036037 -0.4263944 0.4446908</code></pre>
<p>We can check the format of the data with the <code>str()</code> function, or check individual variables with <code>class()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(occ.cov.df)</code></pre></div>
<pre><code>'data.frame':   2505 obs. of  11 variables:
 $ longitude: num  -87.5 -87.8 -88.1 -86.7 -86.7 ...
 $ latitude : num  34.9 34.9 35 34.4 34.6 ...
 $ value    : num  1 1 1 1 1 1 1 1 1 1 ...
 $ type     : chr  "presence" "presence" "presence" "presence" ...
 $ fold     : num  1 1 1 1 1 1 1 1 1 1 ...
 $ pcMix    : num  0.59 0.397 1.501 1.028 0.77 ...
 $ pcDec    : num  1.82 1.88 2.59 1.62 1.46 ...
 $ pcCon    : num  -0.223 -0.119 0.277 -0.138 -0.115 ...
 $ pcGr     : num  -0.319 -0.303 -0.285 -0.325 -0.322 ...
 $ Lat      : num  -0.405 -0.408 -0.41 -0.477 -0.45 ...
 $ Lon      : num  0.414 0.399 0.384 0.462 0.461 ...
 - attr(*, "call_path")=List of 1
  ..$ occurrence: chr "CarolinaWrenPO"
 - attr(*, "covCols")= chr  "pcMix" "pcDec" "pcCon" "pcGr" ...
 - attr(*, "na.action")=Class 'omit'  Named int 218
  .. ..- attr(*, "names")= chr "218"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(occ.cov.df<span class="op">$</span>pcMix)</code></pre></div>
<pre><code>[1] "numeric"</code></pre>
<hr>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#data-summary">Data summary</a></li>
      <li><a href="#outliersdata-cleaning">Outliers/data cleaning</a></li>
      <li><a href="#collinearity">Collinearity</a></li>
      <li><a href="#covariate-report">Covariate Report</a></li>
      <li><a href="#accessor-functions">Accessor functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nick Golding, David Wilkinson, Liz Martin, Saras Windecker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
